import React, { useMemo, useState } from "react";
import styles from "./infoPage.module.css";

export default function InfoPage() {
  const [search, setSearch] = useState("");
  const [openId, setOpenId] = useState("");

  // שאלות ותשובות מנוסחות למשתמשים שלא מכירים את המערכת
  const faqs = useMemo(
    () => [
      // כללי
      {
        id: "about-bidsmart",
        cat: "כללי",
        q: "מה זה BidSmart?",
        a: (
          <p>
            BidSmart היא פלטפורמה למכירות פומביות בזמן אמת. קונים מצטרפים למכירה של מוצר
            שמעניין אותם, מגישים הצעות בזמן אמת, ובסיום המכרז ההצעה הגבוהה ביותר זוכה.
            התשלום מתבצע אונליין באופן מאובטח ולאחר מכן בוחרים משלוח או איסוף עצמי.
          </p>
        ),
      },
      {
        id: "how-it-works",
        cat: "כללי",
        q: "איך זה עובד בקצרה?",
        a: (
          <ol>
            <li>נרשמים לאתר ויוצרים חשבון.</li>
            <li>נכנסים לדף המוצר ולוחצים “הירשם/י למכירה”.</li>
            <li>לפני תחילת המכירה תקבלו תזכורת וטיימר יופיע בדף.</li>
            <li>במהלך המכירה מגישים הצעות בזמן אמת עד לסיום הטיימר.</li>
            <li>הזוכה משלים/ה תשלום מאובטח ובוחר/ת משלוח או איסוף.</li>
          </ol>
        ),
      },
      {
        id: "user-types",
        cat: "כללי",
        q: "אילו סוגי משתמשים קיימים?",
        a: (
          <ul>
            <li><strong>קונה:</strong> נרשם/ת למכירה, מגיש/ה הצעות ומשלם/ת אם זכה/זכתה.</li>
            <li><strong>מוכר:</strong> מעלה מוצרים, פותח מכירות ועוקב אחרי ההצעות.</li>
            <li><strong>מנהל:</strong> משגיח על תקינות המערכת, משתמשים ומכרזים.</li>
          </ul>
        ),
      },

      // הרשמה וחשבון
      {
        id: "create-account",
        cat: "הרשמה וחשבון",
        q: "איך פותחים חשבון?",
        a: (
          <p>
            לוחצים על “התחברות/הרשמה”, ממלאים פרטים בסיסיים ומאשרים את כתובת המייל.
            לאחר התחברות ניתן להירשם למכירות ולהגיש הצעות.
          </p>
        ),
      },
      {
        id: "buyer-to-seller",
        cat: "הרשמה וחשבון",
        q: "איך הופכים מקונה למוכר?",
        a: (
          <p>
            כל משתמש חדש מתחיל כקונה. אם תרצו למכור, תתבקשו להשלים פרטים ואימות בהתאם למדיניות,
            ולאחר האישור תוכלו להעלות מוצרים ולפתוח מכירות.
          </p>
        ),
      },
      {
        id: "reset-password",
        cat: "הרשמה וחשבון",
        q: "שכחתי סיסמה — מה עושים?",
        a: (
          <p>
            בעמוד “שכחתי סיסמה” מזינים את המייל ומקבלים קישור לאיפוס. אם המייל לא הגיע,
            כדאי לבדוק בתיקיית הספאם ולנסות שוב.
          </p>
        ),
      },

      // מכירה חיה והצעות
      {
        id: "join-sale",
        cat: "מכירה חיה והצעות",
        q: "איך נרשמים למכירה של מוצר?",
        a: (
          <ol>
            <li>נכנסים לדף המוצר ולוחצים “הירשם/י למכירה”.</li>
            <li>אם לא מחוברים תופיע בקשת התחברות/הרשמה.</li>
            <li>בדף יוצגו תאריך ושעת ההתחלה ותופיע תזכורת לפני תחילת המכירה.</li>
          </ol>
        ),
      },
      {
        id: "during-live",
        cat: "מכירה חיה והצעות",
        q: "מה קורה בזמן מכירה חיה?",
        a: (
          <ul>
            <li>תראו את המחיר הנוכחי ואת ההצעות שמוגשות בזמן אמת.</li>
            <li>כל הצעה מאושרת תתעדכן מיידית לכל המשתתפים.</li>
            <li>יש הקפצת מינימום בין הצעות, כדי לשמור על קצב הוגן וברור.</li>
          </ul>
        ),
      },
      {
        id: "anti-snipe",
        cat: "מכירה חיה והצעות",
        q: "מה זה מנגנון מניעת ‘חטיפת דקה אחרונה’?",
        a: (
          <p>
            במכרזים מסוימים, אם מתקבלת הצעה ממש לפני הסיום, המערכת מאריכה את הזמן
            בכמה רגעים כדי לאפשר תגובה הוגנת למשתתפים האחרים. כך נמנעת “חטיפה” שנייה לפני הסגירה.
          </p>
        ),
      },
      {
        id: "who-wins",
        cat: "מכירה חיה והצעות",
        q: "איך נקבע הזוכה?",
        a: (
          <p>
            בסיום המכרז, ההצעה הגבוהה ביותר היא הזוכה. תקבלו מסך זכייה ברור והנחיות להמשך תשלום.
          </p>
        ),
      },

      // תשלום ומשלוח
      {
        id: "payment-method",
        cat: "תשלום ומשלוח",
        q: "איך משלמים לאחר זכייה?",
        a: (
          <p>
            משלים/ה תשלום אונליין במערכת סליקה מאובטחת. מיד לאחר אישור התשלום תקבלו אישור,
            ותוכלו לעבור לבחירת שיטת קבלת המוצר.
          </p>
        ),
      },
      {
        id: "payment-deadline",
        cat: "תשלום ומשלוח",
        q: "יש זמן מוגבל לתשלום?",
        a: (
          <p>
            כן. יש פרק זמן סביר להשלמת התשלום לאחר זכייה (מפורט בעמוד המוצר/מדיניות האתר).
            אם התשלום לא הושלם בזמן, ייתכן שניצור קשר עם מציעים אחרים לפי הסדר.
          </p>
        ),
      },
      {
        id: "shipping-options",
        cat: "תשלום ומשלוח",
        q: "איך מקבלים את המוצר — משלוח או איסוף?",
        a: (
          <ul>
            <li><strong>משלוח:</strong> ממלאים טופס כתובת ומאשרים פרטי קשר לשליח.</li>
            <li><strong>איסוף עצמי:</strong> מקבלים פרטי יצירת קשר ותיאום מול המוכר.</li>
          </ul>
        ),
      },
      {
        id: "fees-and-vat",
        cat: "תשלום ומשלוח",
        q: "המחירים סופיים? יש עמלות או מיסים?",
        a: (
          <p>
            המחיר שמוצג לצד המוצר הוא המחיר של ההצעה. ייתכנו עלויות נוספות כמו דמי משלוח
            או חיובים בהתאם למדיניות המוכר והאתר. כל העלויות מוצגות בצורה שקופה לפני התשלום.
          </p>
        ),
      },
      {
        id: "refunds",
        cat: "תשלום ומשלוח",
        q: "אפשר לבטל זכייה או לקבל החזר?",
        a: (
          <p>
            מדיניות ביטולים והחזרים מפורטת בתנאי השימוש ובעמודי המדיניות.
            לפני הגשת הצעה מומלץ לעיין בתנאים ובתיאור המוצר כדי להימנע מחוסר התאמות.
          </p>
        ),
      },

      // פרטיות ובטיחות
      {
        id: "privacy",
        cat: "פרטיות ובטיחות",
        q: "איך הפרטיות שלי מוגנת?",
        a: (
          <p>
            אנחנו שומרים על המידע האישי שלך בהתאם למדיניות פרטיות ברורה ושקופה.
            פרטי תשלום מעובדים אצל ספקי סליקה מאובטחים, והגישה למידע שלך מוגבלת ומפוקחת.
          </p>
        ),
      },
      {
        id: "fair-use",
        cat: "פרטיות ובטיחות",
        q: "איך שומרים על הוגנות ושקיפות?",
        a: (
          <p>
            כל ההצעות מוצגות בזמן אמת לכל המשתתפים, יש בקרה על פעילות חשודה,
            והפרת כללים עלולה להוביל להגבלות על החשבון. המטרה שלנו היא מכרז הוגן ושקוף.
          </p>
        ),
      },

      // תמיכה ושירות
      {
        id: "contact-support",
        cat: "תמיכה",
        q: "איך אפשר ליצור קשר עם התמיכה?",
        a: (
          <p>
            דרך עמוד “צור קשר” ניתן להשאיר פנייה. צוות התמיכה חוזר אליך במייל.
            במקרים דחופים בזמן מכירה כדאי לצרף צילום מסך ולציין שכדאי לטפל בהקדם.
          </p>
        ),
      },
      {
        id: "troubleshooting",
        cat: "תמיכה",
        q: "מה לעשות אם משהו לא עובד לי?",
        a: (
          <ul>
            <li>לרענן את הדף ולבדוק חיבור אינטרנט.</li>
            <li>לוודא שהתחברת לחשבון לפני ההצעה.</li>
            <li>לנקות מטמון/לנסות דפדפן אחר.</li>
            <li>אם לא נפתר — לפנות לתמיכה עם פירוט התקלה ושעת המקרה.</li>
          </ul>
        ),
      },
      {
        id: "notifications",
        cat: "תמיכה",
        q: "האם מקבלים התראות על מכירות חשובות?",
        a: (
          <p>
            כן. תקבלו תזכורות לפני התחלת מכירה שנרשמתם אליה, ועדכונים חשובים במהלך התהליך.
            אפשר לעדכן העדפות התראות באזור החשבון.
          </p>
        ),
      },
    ],
    []
  );

  const filtered = useMemo(() => {
    const s = search.trim().toLowerCase();
    if (!s) return faqs;
    return faqs.filter(
      (x) =>
        x.q.toLowerCase().includes(s) ||
        x.cat.toLowerCase().includes(s)
    );
  }, [search, faqs]);

  const toggle = (id) => setOpenId((prev) => (prev === id ? "" : id));

  return (
    <div className={styles.container}>
      <div className={styles.infoBox}>
        <h1 className={styles.title}>שאלות ותשובות </h1>

        {/* שורת חיפוש — משתמשת במחלקות הקיימות */}
        <div className={styles.section}>
          <label className={styles.label} htmlFor="faqSearch">
            חיפוש לפי נושא או מילת מפתח
          </label>
          <input
            id="faqSearch"
            className={styles.input}
            type="text"
            placeholder="למשל: הרשמה, הצעות, תשלום, משלוח…"
            value={search}
            onChange={(e) => setSearch(e.target.value)}
          />
        </div>

        {/* רשימת שאלות/תשובות — משתמשת במחלקות ה־FAQ שכבר הגדרת */}
        <div className={styles.section}>
          <ul className={styles.faqList}>
            {filtered.map((item) => (
              <li key={item.id} className={styles.faqItem}>
                <button
                  type="button"
                  className={styles.faqQuestion}
                  onClick={() => toggle(item.id)}
                  aria-expanded={openId === item.id}
                  aria-controls={`ans-${item.id}`}
                >
                  <span className={styles.faqQText}>{item.q}</span>
                  <span className={styles.faqBadge}>{item.cat}</span>
                  <span className={styles.faqIcon} aria-hidden>
                    {openId === item.id ? "−" : "+"}
                  </span>
                </button>

                {openId === item.id && (
                  <div id={`ans-${item.id}`} className={styles.faqAnswer}>
                    {item.a}
                  </div>
                )}
              </li>
            ))}
            {filtered.length === 0 && (
              <li className={styles.empty}>לא נמצאו תוצאות לחיפוש.</li>
            )}
          </ul>
        </div>
      </div>
    </div>
  );
}
